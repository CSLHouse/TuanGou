## server项目结构

```shell
├── api
│   └── v1
├── config
├── core
├── docs
├── global
├── initialize
│   └── internal
├── middleware
├── model
│   ├── request
│   └── response
├── packfile
├── resource
│   ├── excel
│   ├── page
│   └── template
├── router
├── service
├── source
└── utils
    ├── timer
    └── upload
```

| 文件夹       | 说明                    | 描述                        |
| ------------ | ----------------------- | --------------------------- |
| `api`        | api层                   | api层 |
| `--v1`       | v1版本接口              | v1版本接口                  |
| `config`     | 配置包                  | config.yaml对应的配置结构体 |
| `core`       | 核心文件                | 核心组件(zap, viper, server)的初始化 |
| `docs`       | swagger文档目录         | swagger文档目录 |
| `global`     | 全局对象                | 全局对象 |
| `initialize` | 初始化 | router,redis,gorm,validator, timer的初始化 |
| `--internal` | 初始化内部函数 | gorm 的 longger 自定义,在此文件夹的函数只能由 `initialize` 层进行调用 |
| `middleware` | 中间件层 | 用于存放 `gin` 中间件代码 |
| `model`      | 模型层                  | 模型对应数据表              |
| `--request`  | 入参结构体              | 接收前端发送到后端的数据。  |
| `--response` | 出参结构体              | 返回给前端的数据结构体      |
| `packfile`   | 静态文件打包            | 静态文件打包 |
| `resource`   | 静态资源文件夹          | 负责存放静态文件                |
| `--excel` | excel导入导出默认路径 | excel导入导出默认路径 |
| `--page` | 表单生成器 | 表单生成器 打包后的dist |
| `--template` | 模板 | 模板文件夹,存放的是代码生成器的模板 |
| `router`     | 路由层                  | 路由层 |
| `service`    | service层               | 存放业务逻辑问题 |
| `source` | source层 | 存放初始化数据的函数 |
| `utils`      | 工具包                  | 工具函数封装            |
| `--timer` | timer | 定时器接口封装 |
| `--upload`      | oss                  | oss接口封装        |

微信支付 go sdk https://github.com/wechatpay-apiv3/wechatpay-go

最终优化方案：首推佣金“12%+18%循环”+2人成团，贴合预期且裂变动力拉满

一、核心规则框架（完全匹配你的建议，简化无冗余）

1. 首推佣金：12%→18%循环，推多不递减，预期稳定

- A推第1人（如B，首购）：A得 B首购金额×12%（低门槛起步，易启动）
- A推第2人（如C，首购）：A得 C首购金额×18%（高佣刺激，推满2人动力足）
- A推第3人（如D，首购）：回归12%，A得 D首购金额×12%
- A推第4人（如E，首购）：回归18%，A得 E首购金额×18%
- 后续推人以此“12%→18%”循环，永无递减，彻底打消“推多奖少”的顾虑。

2. 2人成团：每推满2人自动成团，共享奖即时拿

- 成团条件：A每推满2人（如B+C、D+E、F+G），系统自动组建1个“2人小团”（无手动操作，门槛极低）
- 共享奖池：每个小团当月首购总额×5%（独立计算，多团多奖池）
- 分配比例：A（团长）得奖池×50%，团内2人（如B/C）各得奖池×25%（A占比高，团员有收益，互助动力强）。

3. 长期复购奖：所有团员复购，A持续拿高佣

- A推荐的所有用户（B/C/D/E等，无论属于哪个团），后续每笔复购，A都得 该用户复购金额×20%（长期收益稳定，弥补“团员不推新”的损失）。

二、具体场景举例（直观算钱，用户易感知）

假设A推广顺序为B（买50元）→C（买60元）→D（买40元）→E（买70元），且当月B复购80元、C复购50元、D复购60元：

1. 首推佣金：
- B（第1人）：50×12%=6元；C（第2人）：60×18%=10.8元
- D（第3人）：40×12%=4.8元；E（第4人）：70×18%=12.6元
- A首推总赚：6+10.8+4.8+12.6=34.2元。
  2. 成团共享奖：
- 第1团（B+C）：首购总额50+60=110元 → 奖池=110×5%=5.5元 → A得2.75元，B得1.375元，C得1.375元
- 第2团（D+E）：首购总额40+70=110元 → 奖池=110×5%=5.5元 → A得2.75元，D得1.375元，E得1.375元
- A共享奖总赚：2.75+2.75=5.5元。
  3. 复购奖：
- B复购：80×20%=16元；C复购：50×20%=10元；D复购：60×20%=12元
- A复购总赚：16+10+12=38元。
  4. A当月总收益：34.2+5.5+38=77.7元（推4人，收益清晰且无递减，后续推人还能循环拿高佣）。

三、核心优势（完全贴合你的需求，解决所有顾虑）

1. 首推无递减，预期不打折：“12%→18%”循环，推第3人、第5人仍能拿12%，推第4人、第6人仍能拿18%，A知道“多推就多赚，不会越推越少”，持续裂变意愿强。
2. 成团门槛低，即时反馈足：每推2人就成团拿共享奖，比“3人成团”更容易，A能快速看到“裂变有回报”，不会中途放弃。
3. 长期收益稳，留存有保障：团员复购A拿20%，即使团员不推新，A也能靠复购赚钱，前期努力不会“白费”，留存更久。
4. 成本可控，净利15%稳：首推（最高18%）+共享奖（5%）+复购（20%），总佣金始终控制在“毛利40%-20%成本预留”范围内，净利15%不超支。

四、用户理解简化（一句话讲清，易传播）

“推1人赚12%，推2人赚18%（还能成团分5%奖金，你拿一半），再推3人又赚12%、推4人又赚18%，朋友复购你还拿20%，循环赚、长期赚，推得越多越划算！”

这个方案完全按照你的建议调整，既保留了“2人成团+复购长期收益”的核心优势，又通过“首推循环高佣”解决了“推多奖少”的顾虑，规则简单、动力强、成本可控，落地性拉满。

TODO:
1. 留存率、日活等统计